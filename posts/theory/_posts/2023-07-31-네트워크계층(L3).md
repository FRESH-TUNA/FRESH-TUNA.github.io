---
layout: post
title: "네트워크 계층(L3)"
tags: [network]
comments: true
---

## 개요
네트워크 계층은 네트워크에서 다른 네트워크로의 데이터 패킷을 송수신하는 데 중요한 역할을 하는 OSI(Open Systems Interconnection) 7계층 중 3계층에 속하는 계층이다.

## 라우팅 (Routing)
네트워크 계층은 패킷을 출발지에서 목적지로 안전하게 전달하는 경로를 선택하는 라우팅 기능을 수행한다. 이를 위해 라우팅 알고리즘을 사용하여 최적의 경로를 결정하며, 다양한 경로를 통해 패킷을 전달하는 라우팅 테이블을 관리한다.

## 패킷 분할 및 조립 (Packet Fragmentation and Reassembly)
데이터 링크 계층에서 전송할 수 있는 최대 크기의 패킷보다 큰 데이터를 작은 패킷들로 분할하는 기능을 수행합니다. 수신 측에서는 이러한 작은 패킷들을 다시 원래의 크기로 조립하여 상위 계층에서 원래의 데이터를 복원합니다.

## 주소 할당 (Addressing)
네트워크 계층은 데이터 패킷에 출발지와 목적지의 주소 정보를 부여합니다. 이 주소는 IP 주소를 통해 구분되며, IP 주소는 각 호스트 및 라우터에 할당됩니다.s

다중 경로 지원 (Multicasting):
네트워크 계층은 멀티캐스팅(multicasting) 기능을 제공하여 하나의 출발지에서 여러 목적지로 데이터를 전송할 수 있습니다.

## 서비스 품질 (Quality of Service, QoS):
네트워크 계층은 서비스 품질을 유지하기 위해 트래픽 우선순위, 대역폭 제한 등을 관리한다. 이를 통해 실시간 응용 프로그램에 우선권을 부여하거나 서비스 품질이 중요한 응용 프로그램들에게 최적의 경로를 할당할 수 있다.

## IP 주소
IP 주소는 인터넷 프로토콜(Internet Protocol)을 사용하는 네트워크에서 각 호스트(컴퓨터 또는 네트워크 장치)와 라우터에 할당되는 고유한 주소입니다. IP 주소는 데이터를 출발지에서 목적지로 전송하는 데 사용되며, 패킷을 라우팅하는 데에도 중요한 역할을 한다. IPv4와 IPv6가 가장 널리 사용되는 두 가지 버전의 IP 주소가 있습니다.

IP 주소는 네트워크부분과 호스트부분으로 구성된다.

네트워크 부분은 IP 주소의 네트워크를 식별하는 부분으로, 같은 네트워크에 속한 장치들은 이 부분이 동일하다. 라우터는 이 부분을 사용하여 패킷을 라우팅한다.
호스트 부분은 네트워크 상의 개별 호스트(컴퓨터 또는 장치)를 식별하는 부분이다. 같은 네트워크 내에서도 호스트 부분은 서로 달라야 한다.

## IPv4 와 IPv6
IPv4 (Internet Protocol version 4):
IPv4 주소는 32비트로 구성되며, 일반적으로 4개의 8비트 숫자로 표현된다. 예를 들면, 192.168.1.1과 같이 표기된다.
총 4,294,967,296(2^32)개의 주소가 존재합니다. 하지만 인터넷의 폭발적인 성장으로 인해 주소 고갈이 발생하고 있다.

IPv6 (Internet Protocol version 6):
IPv6 주소는 128비트로 구성되며, 16비트 숫자를 콜론(:)으로 구분하여 표기한다. 예를 들면, 2001:0db8:85a3:0000:0000:8a2e:0370:7334와 같이 표기된다.
총 340,282,366,920,938,463,463,374,607,431,768,211,456(2^128)개의 주소가 존재한다.
주소 고갈 문제를 해결하기 위해 도입되었으며, 더 많은 고유한 주소를 제공한다.

## 네트워크 계층의 흐름 제어
- 라우팅 알고리즘
네트워크 계층은 라우팅 알고리즘을 사용하여 패킷이 출발지에서 목적지로 가는 최적의 경로를 결정한다. 이를 통해 패킷이 최적의 경로로 전송되어 전체 네트워크의 효율성을 향상시킨다.

- TTL(Time to Live)
패킷이 라우터를 통해 전달될 때마다 TTL 필드를 감소시킨다. TTL 값이 0이 되면 패킷은 버려지고, 이를 통해 라우팅 루프와 같은 문제를 방지한다.

- Fragmentation (패킷 분할):
데이터 링크 계층에서 전송할 수 있는 최대 크기의 패킷보다 큰 데이터를 작은 패킷으로 분할합니다. 이를 통해 큰 데이터도 전송할 수 있으며, 네트워크 상황에 맞게 패킷을 전송합니다.

네트워크 계층에서는 오류가 발생한 패킷을 검출하고, 필요에 따라 오류 복구를 수행한다.


## 라우팅 루프
라우팅 루프는 네트워크 상에서 라우팅 경로 정보가 잘못되거나 라우팅 프로토콜이 제대로 작동하지 않을 때 발생한다. 이로 인해 패킷이 무한히 네트워크를 순환하며 목적지에 도달하지 못하게 되는 상황을 의미한다.

라우팅 루프가 발생하는 주요 원인은 다음과 같다
- 잘못된 라우팅 테이블 엔트리: 라우터의 라우팅 테이블에 잘못된 경로 정보가 들어가면 패킷이 올바른 경로를 찾지 못하고 무한히 루프를 돌 수 있다.

- 동적 라우팅 프로토콜 문제: 네트워크에서 사용하는 동적 라우팅 프로토콜들(예: OSPF, RIP 등)이 잘못 구성되거나 정확한 라우팅 정보를 서로 교환하지 못하면 라우팅 루프가 발생할 수 있다.

- 링크 상태 문제: 라우터 간의 링크 상태가 변경되거나 링크에 문제가 발생하면 라우팅 경로 정보가 올바르게 전달되지 않아 루프가 발생할 수 있다.

- 라우팅 프로토콜 수렴 시간: 라우팅 프로토콜은 네트워크 상태가 변경되면 해당 정보를 전파하고 수렴하는 시간이 필요하다. 이러한 수렴 시간 동안 잘못된 경로 정보가 사용될 수 있어 라우팅 루프가 발생할 수 있습.